<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CKEditor</title>
    <script src="../../node_modules/@ckeditor/ckeditor5-inspector/build/inspector.js"></script>
    <script src="../../build/ckeditor.js"></script>
    <style>
        .placeholder, .placeholderBox {
            background-color: yellow;
            border: 1px solid darkgrey;
        }

        .signatureBox {
            background-color:#fefdba;
            padding: 5px 0;
            border: 2px dashed hsl(0, 0%, 77%);
        }

        ol.custom-list {
            counter-reset: item;
        }

        ol.custom-list li {
            display: block;
        }

        ol.custom-list[style] li {
            display: list-item;
        }

        ol.custom-list li:before {
            content: counters(item, '.') '. ';
            counter-increment: item;
        }

        ol.custom-list[style] li:before {
            content: '';
        }
    </style>
</head>
<body>
<div id="editor">
    <p>
        This is some sample content.
        <span class="placeholder">{{placeholder}}</span>
    </p>
</div>
<script>
  // debug variable to dump the ckEditor output
  var ckEditor;

  ClassicEditor
    .create(document.querySelector('#editor'), {
      fontSize: {
        options: ['small', 'default'],
      },
      toolbar: {
        items: [
          'heading',
          '|',
          'bold',
          'italic',
          'underline',
          'strikethrough',
          'link',
          'bulletedList',
          'numberedList',
          'fontFamily',
          'fontSize',
          '|',
          'alignment',
          'indent',
          'outdent',
          'pageBreak',
          '|',
          'blockQuote',
          'insertTable',
          'mediaEmbed',
          'undo',
          'redo',
          '|',
          'placeholder',
          'createPlaceholder',
          'snippet',
          '|',
          'contentModal',
          '|',
          'signatureBox',
          'placeholderBox',
        ],
      },
      contentModalConfig: {
        ctaCopy: 'Insert content',
        openModalHandler: editor => {
          var x = document.getElementById("modal");
          if (x.style.display === "none") {
            x.style.display = "block";
          } else {
            x.style.display = "none";
          }

          editor.model.change(writer => {
            const imageElement = writer.createElement('imageBlock', {
              src: 'https://via.placeholder.com/350x150',
            })

            // Insert the image in the current selection location.
            editor.model.insertContent(imageElement, editor.model.document.selection)
          })
        }
      },
      placeholderConfig: {
        types: ['placeholder_1 asd', 'placeholder_2 dasd', 'placeholder_3 dasda', 'placeholder_4']
      },
      placeholderBoxConfig: {
        placeholders: [
          {
            id: '4324234',
            name: 'placeholder_1',
            label: 'Placeholder 123',
            type: 'signature',
          },
          {
            id: '4324234',
            name: 'placeholder_sign_2',
            label: 'Placeholder 123a',
            type: 'signature',
            optional: 'Micha≈Ç Woszczyna',
          },
          {
            id: '43242345',
            name: 'placeholder_2',
            label: 'Placeholder 2',
            type: 'text',
          },
        ],
        messages: {
          types: {
            text: 'Text',
            signature: 'Signature',
          }
        }
      },

      signatureBoxConfig: {
        signatories: [
          {
            id: '4324234',
            name: 'Michal Woszczyna'
          },
          {
            id: '43242345',
            name: 'John Pervanas'
          },
          {
            id: '43242346',
            name: 'Andrew Jordan'
          }
        ],
        messages: {
          container: 'Signature required',
        }
      },
      snippetConfig: {
        entries: [
          {
            name: "Arsenal",
            items: [
              {
                name: "Organisation Address",
                value: "<b>30 Erica Court</b>"
              },
              {
                name: "Organisation Website",
                value: "www.arsenal.com"
              },
            ]
          },
          {
            name: "Manchester City",
            items: [
              {
                name: "Organisation Address",
                value: "The <b>organisation</b> <i>address</i>"
              },
              {
                name: "Organisation Website",
                value: "www.bbc.co.uk"
              },
            ]
          }
        ]
      },
      createPlaceholderConfig: {
        callback: placeholder => {
          console.log('add new placeholder callback: ' + placeholder);
          return {
            status: 'success',
            placeholder: 'test'
          }

          // error message example
          // return {
          //   status: 'error'
          // }
        }
      }
    })
    .then(editor => {
      CKEditorInspector.attach(editor);
      ckEditor = editor
      console.log(editor);
    })
    .catch(error => {
      console.error(error);
    });
</script>

<div id="modal" style="display: none;">
    Modal content

</div>
</body>
</html>